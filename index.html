<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta charset="utf-8" />
  <title>Predicting phase durations of traffic lights using live Open Traffic Lights data</title>
  <link rel="stylesheet" media="screen" href="styles/screen.css" />
  <link rel="stylesheet" media="print"  href="styles/print.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" media="all"    href="styles/katex.css" />
  <meta name="citation_title" content="Predicting phase durations of traffic lights using live Open Traffic Lights data">
  <meta name="citation_author" content="Brecht Van de Vyvere" />
  <meta name="citation_author" content="Karel D'haene" />
  <meta name="citation_author" content="Kurt D'haene" />
  <meta name="citation_author" content="Pieter Colpaert" />
  <meta name="citation_author" content="Ruben Verborgh" />
  
  <meta name="citation_publication_date" content="2019/07/18" />
</head>

<body prefix="rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns# rdfs: http://www.w3.org/2000/01/rdf-schema# owl: http://www.w3.org/2002/07/owl# xsd: http://www.w3.org/2001/XMLSchema# dcterms: http://purl.org/dc/terms/ dctypes: http://purl.org/dc/dcmitype/ foaf: http://xmlns.com/foaf/0.1/ v: http://www.w3.org/2006/vcard/ns# pimspace: http://www.w3.org/ns/pim/space# cc: https://creativecommons.org/ns# skos: http://www.w3.org/2004/02/skos/core# prov: http://www.w3.org/ns/prov# qb: http://purl.org/linked-data/cube# schema: http://schema.org/ void: http://rdfs.org/ns/void# rsa: http://www.w3.org/ns/auth/rsa# cert: http://www.w3.org/ns/auth/cert# cal: http://www.w3.org/2002/12/cal/ical# wgs: http://www.w3.org/2003/01/geo/wgs84_pos# org: http://www.w3.org/ns/org# biblio: http://purl.org/net/biblio# bibo: http://purl.org/ontology/bibo/ book: http://purl.org/NET/book/vocab# ov: http://open.vocab.org/terms/ sioc: http://rdfs.org/sioc/ns# doap: http://usefulinc.com/ns/doap# dbr: http://dbpedia.org/resource/ dbp: http://dbpedia.org/property/ sio: http://semanticscience.org/resource/ opmw: http://www.opmw.org/ontology/ deo: http://purl.org/spar/deo/ doco: http://purl.org/spar/doco/ cito: http://purl.org/spar/cito/ fabio: http://purl.org/spar/fabio/ oa: http://www.w3.org/ns/oa# as: https://www.w3.org/ns/activitystreams# ldp: http://www.w3.org/ns/ldp# solid: http://www.w3.org/ns/solid/terms# acl: http://www.w3.org/ns/auth/acl# dio: https://w3id.org/dio# as: https://www.w3.org/ns/activitystreams# oa: http://www.w3.org/ns/oa# ldp: http://www.w3.org/ns/ldp#" typeof="schema:CreativeWork sioc:Post prov:Entity">
  <header>
  <h1 id="predicting-phase-durations-of-traffic-lights-using-live-open-traffic-lights-data">Predicting phase durations of traffic lights using live Open Traffic Lights data</h1>

  <ul id="authors">
    <li><a href="https://brechtvdv.github.io/" typeof="http://xmlns.com/foaf/0.1/Person" resource="https://w3id.org/people/brechtvdv/#me">Brecht Van de Vyvere</a></li>
    <li><a href="" typeof="http://xmlns.com/foaf/0.1/Person" resource="">Karel D&#8217;haene</a></li>
    <li><a href="" typeof="http://xmlns.com/foaf/0.1/Person" resource="">Kurt D&#8217;haene</a></li>
    <li><a href="https://pietercolpaert.be" typeof="http://xmlns.com/foaf/0.1/Person" resource="https://pietercolpaert.be/#me">Pieter Colpaert</a></li>
    <li><a href="https://ruben.verborgh.org/" typeof="http://xmlns.com/foaf/0.1/Person" resource="https://ruben.verborgh.org/profile/#me">Ruben Verborgh</a></li>
  </ul>

  <ul id="affiliations">
    <li id="idlab">IDLab,
          Department of Electronics and Information Systems,
          Ghent University – imec</li>
  </ul>

  <section class="context">
    <h2 id="in-reply-to">In reply to</h2>
    <ul>
      <li><a href="https://sem4tra.linkeddata.es/" rel="as:inReplyTo">International Workshop On Semantics For Transport (Sem4Tra)</a></li>
    </ul>
  </section>

</header>

<!-- Hack to make our custom fonts load in print-mode -->
<!-- https://stackoverflow.com/questions/39364259/chrome-print-preview-doesnt-load-media-only-print-font-face -->
<p><span class="printfont1"> </span>
<span class="printfont2"> </span>
<span class="printfont3"> </span>
<span class="printfont4"> </span></p>

<div class="double-column">

 <section id="abstract">
    <h2>Abstract</h2>
    <p>Dynamic traffic lights change their current phase duration according to the situation on the intersection, such as crowdedness. In Flanders, only the minimum and maximum duration of the current phase is published. When route planners want to reuse this data they have to predict how long the current phase will take in order to route over these traffic lights. 
We tested for a live Open Traffic Lights dataset of Antwerp how frequency distributions of phase durations (i) can be used to predict the duration of the current phase and (ii) can be generated client-side on-the-fly with a demonstrator.
An overall mean average error (MAE) of 5.1 seconds is reached by using the median for predictions. A distribution is created for every day with time slots of 20 minutes. This result is better than expected, because phase durations can range between a few seconds and over two minutes.
When taking the remaining time until phase change into account, we see a MAE around 10 seconds when the remaining time is less than a minute which we still deem valuable for route planning. 
Unfortunately, the MAE grows linear for phases longer than a minute making our prediction method useless when this occurs. 
Based on these results, we wish to present two discussion points during the workshop.</p>

    <!-- In future work, we want to minimize the error rate by publishing and reusing a live vehicle counter dataset from the intersection in Antwerp. -->
  </section>


<main>
  <!-- Add sections by specifying their file name, excluding the '.md' suffix. -->
 <section>
      <div class="printonly">This is a print-version of an article first written for the Web. The Web-version is available at <a href="https://brechtvdv.github.io/Article-Predicting-traffic-light-phases">https:/​/​brechtvdv.github.io/Article-Predicting-traffic-light-phases</a>.</div>

      <h2 id="introduction">Introduction</h2>

      <p>The city of Antwerp invested during 2018 in connecting the traffic lights of an intersection to the Internet. With the Open Traffic Lights (OTL) project <span class="references">[<a href="#ref-1">1</a>]</span>, the data about the phase and timing of these traffic lights have been made freely available on the Web as Linked Open Data. Typically, this is used for Green Light Optimal Speed Advisory (GLOSA) <span class="references">[<a href="#ref-2">2</a>]</span> systems to save fuel through speed advice or count-down timer <span class="references">[<a href="#ref-3">3</a>]</span>. While GLOSA systems focus on the event of approaching an intersection, route planners have a more global view of the user journey where fuel savings can be one parameter. 
Implementing live changing data like these in traditional origin-destination route planning APIs would require much more complex tasks such as permanent tracking of the user.</p>

      <p>Recently, work has been done on serverless route planning over <span property="schema:citation http://purl.org/spar/cito/cites" resource="https://dx.doi.org/10.1007/978-3-319-60131-1_26"><a href="https://pietercolpaert.be/papers/icwe2017-lc/paper.pdf">public transport timetables</a></span> <span class="references">[<a href="#ref-4">4</a>]</span> and <a property="schema:citation http://purl.org/spar/cito/cites" href="http://pieter.pm/demo-paper-routable-tiles/">road networks</a> <span class="references">[<a href="#ref-5">5</a>]</span> performing the route planning algorithm on the client-side. This appproach makes the client free to choose how it runs its route planning queries while data owners are only reponsible for publishing its data in an interoperable way. Such a client (cfr. <a href="https://planner.js.org/">Planner.js</a>) can be extended to not only query over road networks, but also take traffic lights data into account. In the Netherlands and Belgium, dynamic traffic lights are installed which change their current phase duration according to detectors (pedestrian counters, cameras etc.). This introduces new challenges <span class="references">[<a href="#ref-6">6</a>]</span>, such as forecasting how long the current phase will likely take. In the Netherlands, opposed to the standard SPAT, it is <a href="https://smartmobilitycommunity.eu/sites/default/files/images/171116%20SPAT%20Profile%20v2.0%20%5BsubWG%20Dutch%20Profile%5D.docx">mandatory</a> to calculate and publish this on the server-side, while in Belgium only the minimum and maximum duration is expected to be published.
In this article, we investigate how the current phase duration of the traffic lights in Antwerp can be predicted and demonstrate this on the client-side.</p>

    </section>

 <section id="related_work">
      <h2>Related work</h2>

      <p>The <a href="https://opentrafficlights.org">Open Traffic Lights</a> (OTL) <span class="references">[<a href="#ref-1">1</a>]</span> project proposes a strategy for publishing traffic lights data in a semantically and technically interoperable way. First, with the OTL ontology, global identifiers (URIs) are defined for a subset of the terms of the currently used data standards SPAT and MAP. SPAT defines the signal phase and timing of a signal group to which a traffic light belongs. MAP defines the geometry of the departure and arrival lanes and how these connections relate to a signal group. By agreeing on the semantics of these terms and applying RDF for describing facts, data publishers are not limited to the currently defined data structure in JSON format. OTL also defines how the data can be published as time-sorted <a href="https://brechtvdv.github.io/Article-Open-Traffic-Lights/#specification">Linked Data Fragments</a>. This allows HTTP clients to not only retrieve the latest value of a signal group, but also its historic values through pagination links which can be used for predicting the signal phase duration of a signal group.</p>

      <p>Predicting the phase duration has been done in related work <span class="references">[<a href="#ref-7">7</a>, <a href="#ref-8">8</a>]</span> where tests have been run on traffic lights with a fixed cycle time. This means that a group of signal phases occur repeatedly between fixed time intervals. Ibrahim et al. <span class="references">[<a href="#ref-7">7</a>]</span> propose a frequency distribution for the phase duration for every signal phase and fixed cycle time, because an intersection can have a different fixed cycle time during working days than in the weekend. Bodenheimer et al. <span class="references">[<a href="#ref-8">8</a>]</span> use graph transformations for representing the phase changes. For the prediction of the duration, they use timeslots of 15 minutes and different day classes (e.g. regular versus vacation day). The latter has been extended in <span class="references">[<a href="#ref-9">9</a>]</span> for dynamic traffic lights and makes clear that prediction errors can be decreased significantly by having access to all detector information.</p>

      <!-- Using the cumulative frequency distribution also allows predicting with a fixed probability <span class="references">\[<a href="#ref-10">10</a>\]</span>. For example: when 10% of the historic phase durations happened before the predicted phase duration $$d_p$$, so $$F(d_p) = 0.1$$, then we can say with a probability of 90% ($$1-F(d_p)$$) that the real phase duration $$d$$ will take longer than $$d_p$$. -->

      <!-- The idea is that historical values are a good reflection of future phases, so future phases will have a similar frequency distribution. The chance that a real phase duration will happen before the predicted duration corresponds with $$P(d≤d_p) = F(d_p)$$. 

For example: it is 90% sure that a phase will take longer when choosing a phase duration as prediction that corresponds with the first 10% of the cumulative frequency distribution.

the probability $$a$$ that the real phase duration $$d$$ takes longer than the predicted duration $$d_p$$ ($$a = P(d>d_p))$$). By taking the cumulative frequency distribution of phase durations $$F$$, then the chance that the . We can calculate $$a$$ by taking the reverse with the formula: $$a = 1-F(d_p)$$. This allows predicting with a fixed  -->

    </section>

  <section id="predicting-the-phase-duration">
      <h2>Predicting the phase duration</h2>

      <!-- <span class="comment" data-author="RV">You don't say which algo you are using and why. Not enough to reproduce.</span>
 -->
      <p>To be able to predict the phase duration of a dynamically changing traffic light phase, there are two steps we take: first, we create frequency distributions like in related work <span class="references">[<a href="#ref-7">7</a>]</span> from a dataset with occured phases and then we predict the duration by using a certain method on the distribution that is relevant for the tested phase. 
Since traffic patterns can change depending on the time of the day or day of the week, we tested multiple strategies <span class="references">[<a href="#ref-9">9</a>]</span> to group signal phases for the creation of a distribution.
As a baseline, frequency distributions are created for every signal group and signal phase. 
Then we grouped phases according to its type of day (weekday or weekend) and in time slots of every hour. The reasoning behind this is that a traffic light interacts differently during the weekends and peak hours. As last strategy we grouped per day (Monday, Tuesday…) and in time slots of 20 minutes.
To predict the duration of a phase from a received SPAT message, we tested a few basic selectors: mean, mode and average. These selectors only consider phase durations that take longer than its current duration, because these are still historically possible to occur.
We chose these selectors instead of graph transformations <span class="references">[<a href="#ref-8">8</a>]</span>, because we <a href="https://kridhaen.github.io/OpenTrafficLightsDistributionsVisualizer/">discovered</a> that certain phase durations of our tested dataset occur more frequently than others which creates peaks in its frequency distribution. This made us hypothesize that this behavior will benefit using a method like the mean.
Finally, to express the prediction error we calculate the mean absolute error (MEA) for every signal group update <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> as follows <span class="references">[<a href="#ref-7">7</a>]</span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>p</mi></msub><mo>(</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">d_p(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span> is the predicted duration and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">d(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span> the real duration of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>: 
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>E</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi mathvariant="normal">&#x2223;</mi><msub><mi>d</mi><mi>p</mi></msub><mo>(</mo><mi>i</mi><mo>)</mo><mo>&#x2212;</mo><mi>d</mi><mo>(</mo><mi>i</mi><mo>)</mo><mi mathvariant="normal">&#x2223;</mi></mrow><annotation encoding="application/x-tex">MAE = \dfrac{1}{n}\sum_{i=1}^n|d_p(i)-d(i)|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">&#x2223;</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mord">&#x2223;</span></span></span></span> .</p>

      <h2 id="results">Results</h2>

      <p>We use the traffic lights data from the intersection in Antwerp which has a <a href="http://docs.wegenenverkeer.be/Publicaties/Brochure%20Verkeerslichtengeregelde%20kruispunten.pdf">dynamic cycle and phase timing</a>.
To run reproducible tests, we harvested a <a href="https://github.com/kridhaen/OpenTrafficLightsData">dataset</a> from 8th till 25th March 2019 from the OTL endpoint containing 50951 historical fragments.
The test cases are ran using 10-fold cross validation. First, we extracted the phase and timing of signal groups and randomly divided these in 10 groups. Then we replayed every signal group update <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> from a SPAT message, who belongs in one group, and predicted its duration <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">d_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> using the frequency distributions made from the other 9 groups and compared it with its real duration <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>. Only signal group updates where its duration is unknown (minimum and maximum duration differ) are considered.</p>

      <p><a href="#mae-prediction">Table 1</a> shows the MAE for every grouping strategy and method we applied. We see that fine-grained grouping of phases improves the MAE which acknowledges related work <span class="references">[<a href="#ref-9">9</a>]</span>. Also, using the median returns lower prediction errors than the mean and mode.
A very good result is considered around 2s according to Bodeheimer et al. <span class="references">[<a href="#ref-9">9</a>]</span>, but for a basic algorithm and without using external detector information an overall MAE of 5.1s is still lower than expected. Especially because this test also considers updates whose time till phase change is still very high (above 30s) and probably have a high prediction error.</p>

      <figure id="mae-prediction" class="table">

        <table>
          <thead>
            <tr>
              <th>Method</th>
              <th>No grouping (s)</th>
              <th>Per type of day and every hour (s)</th>
              <th>Per day and every 20 minutes (s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Median</td>
              <td><code>6.8</code></td>
              <td><code>5.5</code></td>
              <td><code>5.1</code></td>
            </tr>
            <tr>
              <td>Mean</td>
              <td><code>7.0</code></td>
              <td><code>5.9</code></td>
              <td><code>5.6</code></td>
            </tr>
            <tr>
              <td>Mode</td>
              <td><code>7.6</code></td>
              <td><code>6.2</code></td>
              <td><code>6.0</code></td>
            </tr>
          </tbody>
        </table>

        <figcaption>
          <p><span class="label">Table 1:</span> An overall prediction error of 5.1s is good, because a prediction is made for every SPAT message without using external datasets. This hints that some dynamic traffic lights of Antwerp probably follow a predictable pattern which is good for route planning.</p>

          <!-- <span class="comment" data-author="RV">Don't tell what we see—interpret. What are we supposed to see? Good, bad?</span>
 -->
        </figcaption>
      </figure>

      <p>To test this causality between the MAE of a signal group and its time until phase change, we plotted this in <a href="#time-till-transition">Fig. 1</a> for one <a href="https://opentrafficlights.org/id/signalgroup/K648/3">signal group</a> showing signal phase “<a href="https://w3id.org/opentrafficlights/thesauri/signalphase/3">Stop and remain</a>” (red line) and “<a href="https://w3id.org/opentrafficlights/thesauri/signalphase/6">Protected Movement Allowed</a>” (green line). The other signal groups can be found at <a href="https://kridhaen.github.io/OpenTrafficLightsDistributionsVisualizer/">https:/​/​kridhaen.github.io/OpenTrafficLightsDistributionsVisualizer/</a> by pressing the arrow button to “Visualization of the prediction error for each time to phase change for large dataset”.
The latter signal phase shows a prediction error of almost 0s which can be confirmed with its <a href="https://kridhaen.github.io/OpenTrafficLightsDistributionsVisualizer/">frequency distribution</a>: its phase duration generally takes 15s and exceptionally 18s. With this knowledge, route planners can safely assume that this signal group will have a green time of at least 15s.
For the former signal phase, we see three findings. 
First, between 0s and 9s there is no prediction error, because the minimum duration equaled the maximum duration. Next, we see a flat line for phase durations between 9s and 65s with a MAE around 10s. Although we don’t know the exact distribution of the errors, a route planner needs to be aware that the prediction is on average this much off so it must do a best-effort to minimize the consequences for the driver. For example, when the phase is 60s before change: one the one hand a prediction of 50s can lead to 10s of waiting before a red light, on the other hand a prediction of 70s means that it is already 10s green with 5s remaining. This raises a new challenge whether the driver will be able to pass the green light in those 5s depending on the crowdedness.
Lastly, above 65s the prediction error grows linear. Although these long phase durations occur exceptionally, otherwise the overall MAE would be much higher, route planning during such a phase would return completely unreliable results.</p>

      <figure id="time-till-transition">
<center>
<img style="height: auto; width: 70%" src="img/time-till-transition-3.svg" />
</center>
<figcaption>
          <p><span class="label">Fig. 1:</span> Predicting the duration of signal phase “Protected Movement Allowed” (green line) for this signal group is perfectly possible as its prediction error is almost 0s. 
For signal phase “Stop and remain” (red line), we deem a prediction error around 10s still valuable for route planning.</p>
        </figcaption>
</figure>

      <!-- <span class="comment" data-author="RV">Good, bad, success, failure??</span>
 -->

    </section>

  <section id="demonstrator">
      <h2>Demonstrator</h2>

      <p>This Web <a href="https://codepen.io/kridhaen/pen/VJrezO/">application</a> demonstrates the prediction of the current phase duration of a live traffic light in <a href="https://www.openstreetmap.org/#map=19/51.21205/4.39717">Antwerp</a>. The green, red and blue line on the chart shows respectively the minimum, maximum and predicted duration in seconds of the phase. 
This client harvests the latest data from the Open Traffic Lights <a href="https://lodi.ilabt.imec.be/observer/rawdata/latest">API</a> and constructs frequency distributions with the same strategy as <a href="#results">Section 4</a>.
This vizualization shows us that the minimum and maximum duration can differ tens of seconds, especially in the beginning. With the predicted phase, a user can have a better understanding how long the phase will probably take.
Also when the minimum and maximum duration align, and thus it becomes certain how long the phase take, the blue line gets mostly corrected with a few seconds. This behavior hints to our result from the average prediction error (<a href="#mae-prediction">Table 1</a>).
The source code is available at <a href="https://codepen.io/kridhaen/pen/VJrezO/">https:/​/​codepen.io/kridhaen/pen/VJrezO/</a>.</p>

      <figure id="codepen">
<center>
<img src="img/demo-2.png" />
</center>
<figcaption>
          <p><span class="label">Fig. 2:</span> The blue line shows the predicted phase duration which gives a better understanding how this relates to the minimum (green) and maximum (red) phase duration and whether it was a good prediction in the end.</p>
        </figcaption>
</figure>

      <p class="codepen" data-height="761" data-theme-id="0" data-default-tab="result" data-user="kridhaen" data-slug-hash="VJrezO" style="height: 761px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="OpenTrafficLightsPredictor">
  <span>See the Pen <a href="https://codepen.io/kridhaen/pen/VJrezO/">
  OpenTrafficLightsPredictor</a> by kridhaen (<a href="https://codepen.io/kridhaen">@kridhaen</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
      <script async="" src="https://static.codepen.io/assets/embed/ei.js"></script>

    </section>

  <section id="discussion">
      <h2>Discussion</h2>

      <p>A route planner can predict a fixed phase duration, e.g. the phase will probably last 20 seconds, with a frequency distribution and selector like the mean, but can it anticipate on the error this prediction brings?
By transforming the frequency distribution to a cumulative frequency distribution, routing with a fixed probability is possible. For example, when 90% of historical phase durations happened before a certain duration, then a route planner can be 90% sure that the phase will change before that time. This fixed probability can be configured as a user preference and also gives the possibility to cut off the exceptionally long phase durations from the time until phase change curve (<a href="#time-till-transition">Fig. 1</a>). A route planner can retrieve the maximum MAE from the left-side part of the curve to have an indication how much the predicted duration is averagely off in worst case and anticipate with it, e.g. will the driver still be on time for a green light or is there another route with less waiting time for a red light? Also this maximum MAE can be configured by the user which it deems usefull for routing.
As a first discussion point (i), we would like to discuss whether a user should be able to configure a minimum probability or leave this responsibility to the data publisher, like in the Netherlands.
In future work, we suggest to also use a frequency distribution for the variance of prediction errors instead of only calculating the MAE value.
Whether a predicted phase duration is useful also depends on other factors, such as the crowdedness in the streets. When it is very crowded, we deem data about travel times between points more usefull than traffic lights data, because the driver does not have the flexibility to time its arrival at an intersection.
Finally, related work <span class="references">[<a href="#ref-9">9</a>]</span> has already demonstrated that having access to all detector information lowers the prediction error significantly. This brings us to our second discussion point (ii): what would enable a better description of how a traffic light is connected with other sensors in the broader context of a city (cfr. Digital Twin)?
As a next step, we will publish a live vehicle counter dataset from the intersection in Antwerp as Linked Open Data and reuse this for lowering the prediction error.</p>

      <!-- Different approaches are possible to create these distributions over the Web: on the one hand, a client can do all the work, which we showed in our demo, by downloading fragments from the [OTL API](https://lodi.ilabt.imec.be/observer/rawdata/latest) and building the distributions client-side.
<span class="comment" data-author="RV">Why is that relevant though? This is about the goodness of the prediction, not about who does it?</span>
This requires high bandwidth consumption and processing power, but allows new ways of grouping signal phases. For example by querying other Open Datasets (weather data, crowdedness detectors at the intersection...). On the other hand, the server can internally maintain frequency distributions and only publish the likely time and confidence in SPAT messages. Although this answers the current SPAT standard, this gives no flexibility for the client to e.g. predict an interval instead of one phase duration. A third option is to publish frequency distributions as metadata of a signal group. This introduces a new trade-off between server and client effort: frequency distributions can be exposed as cacheable fragments supporting serverless route planning interfaces, while clients can still mix these with other datasets and setting custom prediction preferences.  
 -->
      <!-- <span class="comment" data-author="RV">Why? That seems unrelated.</span>
 -->

    </section>

</main>

<footer>
<section id="references">
<h2>References</h2>
<dl class="references">
  <dt id="ref-1">[1]</dt>
  <dd resource="#vandevyvere_mepdaw_2019" typeof="schema:Article">Van de Vyvere, B., Colpaert, P., Mannens, E., Verborgh, R.: Open traffic lights: a strategy for publishing and preserving traffic lights data. In: Proceedings of the 5th Workshop on Managing the Evolution and Preservation of the Data Web (2019).</dd>
  <dt id="ref-2">[2]</dt>
  <dd resource="https://dx.doi.org/10.1109/ICCVE.2013.6799846" typeof="schema:Article">Zweck, M., Schuch, M.: Traffic light assistant: Applying cooperative ITS in European cities and vehicles. In: 2013 International Conference on Connected Vehicles and Expo (ICCVE). pp. 509–513 (2013).</dd>
  <dt id="ref-3">[3]</dt>
  <dd resource="https://dx.doi.org/10.1109/FISTS.2011.5973594" typeof="schema:Article">Barth, M., Mandava, S., Boriboonsomsin, K., Xia, H.: Dynamic ECO-driving for arterial corridors. In: 2011 IEEE Forum on Integrated and Sustainable Transportation Systems, FISTS 2011. pp. 182–188 (2011).</dd>
  <dt id="ref-4">[4]</dt>
  <dd resource="https://dx.doi.org/10.1007/978-3-319-60131-1_26" typeof="schema:Article">Colpaert, P., Verborgh, R., Mannens, E.: Public Transit Route Planning through Lightweight Linked Data Interfaces. In: Cabot, J., Virgilio, R. de, and Torlone, R. (eds.) Proceedings of the 17th International Conference on Web Engineering. pp. 403–411. Springer (2017).</dd>
  <dt id="ref-5">[5]</dt>
  <dd resource="http://pieter.pm/demo-paper-routable-tiles/" typeof="schema:Article">Colpaert, P., Abelshausen, B., Rojas Meléndez, J., Delva, H., Verborgh, R.: Republishing Open Street Map’s roads as Linked Routable Tiles. In: Proceedings of the 16th ESWC: Posters and Demos (2019).</dd>
  <dt id="ref-6">[6]</dt>
  <dd resource="#spat_amsterdam" typeof="schema:CreativeWork">Amelink, M.: Signal phase and time (SPAT) and map data (MAP). Amsterdam group (2015).</dd>
  <dt id="ref-7">[7]</dt>
  <dd resource="https://dx.doi.org/10.1109/TITS.2018.2873150" typeof="schema:Article">Ibrahim, S., Kalathil, D., Sanchez, R.O., Varaiya, P.: Estimating Phase Duration for SPaT Messages. IEEE Transactions on Intelligent Transportation Systems. 20, 2668–2676 (2019).</dd>
  <dt id="ref-8">[8]</dt>
  <dd resource="https://dx.doi.org/10.1109/VNC.2014.7013336" typeof="schema:Article">Bodenheimer, R., Brauer, A., Eckhoff, D., German, R.: Enabling GLOSA for adaptive traffic lights. In: 2014 IEEE Vehicular Networking Conference (VNC). pp. 167–174 (2014).</dd>
  <dt id="ref-9">[9]</dt>
  <dd resource="https://dx.doi.org/10.1109/RNDM.2015.7325247" typeof="schema:Article">Bodenheimer, R., Eckhoff, D., German, R.: GLOSA for adaptive traffic lights: Methods and evaluation. In: 2015 7th International Workshop on Reliable Networks Design and Modeling (RNDM). pp. 320–328 (2015).</dd>
  <dt id="ref-10">[10]</dt>
  <dd resource="https://dx.doi.org/10.1109/VTCFall.2014.6965983" typeof="schema:Article">Protschky, V., Feit, S., Linnhoff-Popien, C.: Extensive Traffic Light Prediction under Real-World Conditions. In: 2014 IEEE 80th Vehicular Technology Conference (VTC2014-Fall). pp. 1–5 (2014).</dd>
</dl>
</section>
</footer>

</div>



</body>
</html>
